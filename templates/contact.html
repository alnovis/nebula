{% extends "base.html" %}

{% block head %}
{% match turnstile_site_key %}
{% when Some with (key) %}
<script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
{% when None %}
{% endmatch %}
{% endblock %}

{% block content %}
<article class="contact-page">
    <h1>{{ title }}</h1>
    <p>Have a question or want to work together? Send me a message and I'll get back to you.</p>

    {% match error %}
    {% when Some with (err) %}
    <div class="form-error" style="background: rgba(239, 68, 68, 0.1); border: 1px solid #ef4444; padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
        <p style="color: #ef4444; margin: 0;">{{ err }}</p>
    </div>
    {% when None %}
    {% endmatch %}

    <form class="contact-form" method="post" action="/contact">
        <div class="form-group">
            <label for="name">Name *</label>
            <input type="text" id="name" name="name" required
                   value="{{ form_name }}"
                   placeholder="Your name">
        </div>

        <div class="form-group">
            <label for="email">Email *</label>
            <input type="email" id="email" name="email" required
                   value="{{ form_email }}"
                   placeholder="your@email.com">
        </div>

        <div class="form-group">
            <label for="subject">Subject</label>
            <input type="text" id="subject" name="subject"
                   value="{{ form_subject }}"
                   placeholder="What's this about?">
        </div>

        <div class="form-group">
            <label for="message">Message *</label>
            <textarea id="message" name="message" required
                      placeholder="Your message...">{{ form_message }}</textarea>
        </div>

        <!-- Cloudflare Turnstile CAPTCHA -->
        {% match turnstile_site_key %}
        {% when Some with (key) %}
        <div class="form-group">
            <div class="cf-turnstile" data-sitekey="{{ key }}" data-theme="dark"></div>
        </div>
        {% when None %}
        {% endmatch %}

        <!-- Honeypot field for spam protection (backup if no Turnstile) -->
        <div class="honeypot" aria-hidden="true">
            <label for="website">Website</label>
            <input type="text" id="website" name="website" tabindex="-1" autocomplete="off">
        </div>

        <button type="submit" class="btn-submit">Send Message</button>
    </form>

    <p style="margin-top: 2rem; color: var(--color-text-muted); font-size: 0.9rem;">
        Or reach out directly at <a href="mailto:{{ author_email }}">{{ author_email }}</a>
    </p>
</article>
{% endblock %}
